"use strict";(self.webpackChunkreact_people_table_advanced=self.webpackChunkreact_people_table_advanced||[]).push([[509],{509:function(e,s,r){r.r(s),r.d(s,{default:function(){return Z}});var a,n=r(214),t=r(683),l=r(861),c=r(885),i=r(980),o=r(791),d=r(501),u=r(871),h=r(982),m=r(694),x=r.n(m),p=["16","17","18","19","20"];!function(e){e.ALL="All",e.MALE="Male",e.FEMALE="Female"}(a||(a={}));var f=r(925);function j(e,s){var r=new URLSearchParams(e.toString());return Object.entries(s).forEach((function(e){var s=(0,c.Z)(e,2),a=s[0],n=s[1];null===n?r.delete(a):Array.isArray(n)?(r.delete(a),n.forEach((function(e){r.append(a,e)}))):r.set(a,n)})),r.toString()}var N,g=r(184),v=["children","params"],b=function(e){var s=e.children,r=e.params,a=(0,f.Z)(e,v),n=(0,d.lr)(),l=(0,c.Z)(n,1)[0];return(0,g.jsx)(d.rU,(0,t.Z)((0,t.Z)({to:{search:j(l,r)}},a),{},{children:s}))},w=function(e){var s=e.searchParams,r=e.setSearchParams,n=e.query,t=e.sex,l=e.centuries;return(0,g.jsxs)("nav",{className:"panel",children:[(0,g.jsx)("p",{className:"panel-heading",children:"Filters"}),(0,g.jsxs)("p",{className:"panel-tabs","data-cy":"SexFilter",children:[(0,g.jsx)(b,{params:{sex:null},className:x()({"is-active":!t}),children:a.ALL}),(0,g.jsx)(b,{params:{sex:"m"},className:x()({"is-active":"m"===t}),children:a.MALE}),(0,g.jsx)(b,{params:{sex:"f"},className:x()({"is-active":"f"===t}),children:a.FEMALE})]}),(0,g.jsx)("div",{className:"panel-block",children:(0,g.jsxs)("p",{className:"control has-icons-left",children:[(0,g.jsx)("input",{"data-cy":"NameFilter",type:"search",className:"input",placeholder:"Search",value:n||"",onChange:function(e){e.target.value.trim()&&r(j(s,{query:e.target.value||null}))}}),(0,g.jsx)("span",{className:"icon is-left",children:(0,g.jsx)("i",{className:"fas fa-search","aria-hidden":"true"})})]})}),(0,g.jsx)("div",{className:"panel-block",children:(0,g.jsx)("div",{className:"level is-flex-grow-1 is-mobile","data-cy":"CenturyFilter",children:(0,g.jsxs)("div",{className:"level-left",children:[p.map((function(e){return(0,g.jsx)(b,{params:{centuries:l.includes(e.toString())?l.filter((function(s){return s!==e.toString()})):[].concat((0,h.Z)(l),[e])},"data-cy":"century",className:x()("button","mr-1",{"is-info":l.includes(e.toString())}),children:e},e)})),(0,g.jsx)("div",{className:"level-right ml-4",children:(0,g.jsx)(b,{params:{centuries:null},"data-cy":"centuryALL",className:x()("button",{"is-success":!l.length},{"is-outlined":l.length}),children:"All"})})]})})}),(0,g.jsx)("div",{className:"panel-block",children:(0,g.jsx)(b,{params:{sex:null,query:null,centuries:null},className:"button is-link is-outlined is-fullwidth",children:"Reset all filters"})})]})},E=r(348),y=function(e){var s=e.person,r=e.slug,a=(0,u.TH)(),n=(0,u.WU)("../").pathname,t=function(e){return e===r},l=s.name,c=s.sex,i=s.born,o=s.died,h=s.motherName,m=s.mother,p=s.father,f=s.fatherName,j=s.slug,N=h||"-",v=f||"-";return(0,g.jsxs)("tr",{"data-cy":"person",className:x()({"has-background-warning":t(j)}),children:[(0,g.jsx)("td",{children:(0,g.jsx)(d.rU,{to:{pathname:t(j)?n:n+j,search:a.search},className:x()({"has-text-danger":"f"===c}),children:l})}),(0,g.jsx)("td",{children:c}),(0,g.jsx)("td",{children:i}),(0,g.jsx)("td",{children:o}),(0,g.jsx)("td",{children:m?(0,g.jsx)(d.rU,{to:{pathname:t(m.slug)?n:n+m.slug,search:a.search},className:"has-text-danger",children:m.name}):N}),(0,g.jsx)("td",{children:p?(0,g.jsx)(d.rU,{to:{pathname:t(p.slug)?n:n+p.slug,search:a.search},children:p.name}):v})]})};!function(e){e.NAME="name",e.SEX="sex",e.BORN="born",e.DIED="died"}(N||(N={}));var S=function(e){var s=e.people,r=e.slug,a=(0,d.lr)(),n=(0,c.Z)(a,1)[0],t=n.get("order")||null,l=n.get("sort")||null;return(0,g.jsxs)("table",{"data-cy":"peopleTable",className:"table is-striped is-hoverable is-narrow is-fullwidth",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:(0,g.jsxs)("span",{className:"is-flex is-flex-wrap-nowrap",children:["Name",(0,g.jsx)(b,{params:{sort:l===N.NAME&&t?null:N.NAME,order:l!==N.NAME||t?null:"desc"},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)("i",{className:"fas fa-sort"})})})]})}),(0,g.jsx)("th",{children:(0,g.jsxs)("span",{className:"is-flex is-flex-wrap-nowrap",children:["Sex",(0,g.jsx)(b,{params:{sort:l===N.SEX&&t?null:N.SEX,order:l!==N.SEX||t?null:"desc"},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)("i",{className:"fas fa-sort"})})})]})}),(0,g.jsx)("th",{children:(0,g.jsxs)("span",{className:"is-flex is-flex-wrap-nowrap",children:["Born",(0,g.jsx)(b,{params:{sort:l===N.BORN&&t?null:N.BORN,order:l!==N.BORN||t?null:"desc"},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)("i",{className:"fas fa-sort-up"})})})]})}),(0,g.jsx)("th",{children:(0,g.jsxs)("span",{className:"is-flex is-flex-wrap-nowrap",children:["Died",(0,g.jsx)(b,{params:{sort:l===N.DIED&&t?null:N.DIED,order:l!==N.DIED||t?null:"desc"},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)("i",{className:"fas fa-sort"})})})]})}),(0,g.jsx)("th",{children:"Mother"}),(0,g.jsx)("th",{children:"Father"})]})}),(0,g.jsx)("tbody",{children:s.map((function(e){return(0,g.jsx)(y,{person:e,slug:r},e.slug)}))})]})},A=function(e){return e.toLowerCase()},Z=function(){var e=(0,o.useState)([]),s=(0,c.Z)(e,2),r=s[0],a=s[1],m=(0,o.useState)(!0),x=(0,c.Z)(m,2),p=x[0],f=x[1],j=(0,o.useState)(!1),v=(0,c.Z)(j,2),b=v[0],y=v[1],Z=(0,o.useRef)(!1),k=(0,d.lr)(),M=(0,c.Z)(k,2),L=M[0],D=M[1],F=L.get("query")||"",C=L.get("sex")||"",P=L.getAll("centuries")||[],R=L.get("sort")||"",O=L.get("order")||"",U=(0,u.UO)().slug,_=void 0===U?"":U,B=function(){var e=(0,l.Z)((0,n.Z)().mark((function e(){var s,r,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new AbortController,e.prev=1,f(!0),y(!1),e.next=6,i.Z.get("https://mate-academy.github.io/react_people-table/api/people.json",{signal:s.signal});case 6:r=e.sent,l=r.data,Z&&l.length&&(c=l.map((function(e){return(0,t.Z)((0,t.Z)({},e),{},{mother:l.find((function(s){return s.name===e.motherName})),father:l.find((function(s){return s.name===e.fatherName}))})})),a(c)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),y(!0);case 14:return e.prev=14,f(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){return Z.current=!0,setTimeout(B,500),function(){a([]),Z.current=!1}}),[]);var T=(0,o.useMemo)((function(){return function(e,s,r,a,n,t){var l=A(e).trim(),c=(0,h.Z)(t);return l&&(c=c.filter((function(e){return A(e.name).includes(l)||e.motherName&&A(e.motherName).includes(l)||e.fatherName&&A(e.fatherName).includes(l)}))),r.length&&(c=c.filter((function(e){var s=Math.ceil(e.born/100).toString();return!!r.includes(s)}))),s&&(c=c.filter((function(e){return e.sex===s}))),a&&(c=c.sort((function(e,s){switch(a){case N.NAME:return e.name.localeCompare(s.name);case N.SEX:return e.sex.localeCompare(s.sex);case N.BORN:return e.born-s.born;case N.DIED:return e.died-s.died;default:throw new Error("The sort type is not defined")}}))),n&&c.reverse(),c}(F,C,P,R,O,r)}),[F,C,P]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h1",{className:"title",children:"People Page"}),(0,g.jsx)("div",{className:"block",children:(0,g.jsxs)("div",{className:"columns is-desktop is-flex-direction-row-reverse",children:[(0,g.jsx)("div",{className:"column is-7-tablet is-narrow-desktop",children:r.length>0&&(0,g.jsx)(w,{searchParams:L,setSearchParams:D,query:F,sex:C,centuries:P})}),(0,g.jsx)("div",{className:"column",children:(0,g.jsxs)("div",{className:"box table-container",children:[p&&(0,g.jsx)(E.a,{}),b&&!p&&(0,g.jsx)("p",{"data-cy":"peopleLoadingError",className:"has-text-danger",children:"Something went wrong"}),!r.length&&!p&&!b&&(0,g.jsx)("p",{"data-cy":"noPeopleMessage",children:"There are no people on the server"}),!p&&!T.length&&!b&&(0,g.jsx)("p",{children:"There are no people matching the current search criteria"}),r.length>0&&(0,g.jsx)(S,{people:T,slug:_})]})})]})})]})}}}]);
//# sourceMappingURL=509.78921b6a.chunk.js.map